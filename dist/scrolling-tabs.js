"use strict";!function(t){function e(t){this.stc=t}function n(t){this.stc=t}function o(t){this.stc=t}function i(t,i,r){var a=this;a.$tabsContainer=t,a.$timeout=i,a.movableContainerLeftPos=0,a.scrollArrowsVisible=!1,a.scrollToTabEdge=!1,a.scrollMovement=new o(a),a.eventHandlers=new e(a),a.elementsHandler=new n(a),a.scrollingTabsActiveOffset=r.scrollingTabsActiveOffset||0}function r(e,n){function o(t){return n.trustAsHtml(t)}return{restrict:"E",template:c,transclude:!1,replace:!0,scope:{tabs:"@",watchTabs:"=",propPaneId:"@",propTitle:"@",propActive:"@",propDisabled:"@",localTabClick:"&tabClick",refreshOn:"="},link:function(n,r,a){var s=new i(r,e),l=a.scrollToTabEdge&&"true"===a.scrollToTabEdge.toLowerCase();if(n.tabsArr=n.$eval(n.tabs),n.propPaneId=n.propPaneId||"paneId",n.propTitle=n.propTitle||"title",n.propActive=n.propActive||"active",n.propDisabled=n.propDisabled||"disabled",n.sanitize=o,r.on("click.scrollingTabs",".nav-tabs > li",function(e){var o=t(this).data();n.localTabClick({$event:e,$index:o.index,tab:o.tab})}),a.refreshOn&&n.$watch("refreshOn",function(t,e){t&&t!==e&&s.handleTriggeredRefresh()}),!a.watchTabs)return void s.initTabs({isWrapperDirective:!1,scrollToTabEdge:l,scrollingTabsActiveOffset:a.scrollingTabsActiveOffset});n.$watch("watchTabs",function(t){var o=void 0,i=void 0;n.tabsArr=n.$eval(n.tabs),t.length&&t[t.length-1].active?e(function(){r.find("ul.nav-tabs > li:last").removeClass("active").find('a[role="tab"]').click()},0):(o=r.find(".nav-tabs > li.active"),o.length&&(i=o.data("index"),n.tabsArr.some(function(t){return!!t[n.propActive]&&(t[n.propActive]=!1,!0)}),n.tabsArr[i][n.propActive]=!0)),s.initTabs({isWrapperDirective:!1,isWatchingTabs:!0,scrollToTabEdge:l})},!0)}}}function a(t){return{restrict:"A",template:b,transclude:!0,replace:!0,link:function(e,n,o){function r(t){s.initTabs({isWatchingDom:t&&t.isWatchingDom,isWatchingTabs:!0,isWrapperDirective:!0,isWrappingAngularUITabset:c,scrollToTabEdge:b})}function a(){function o(){return a=i.find("li.active").index(),a!==s&&(s=a,r({isWatchingDom:!0})),!1}var i=n.find("ul.nav-tabs"),a=void 0,s=void 0;i.length&&(e.$watch(function(){return i[0].childNodes.length},function(t,e){t!==e&&r({isWatchingDom:!0})}),e.$watch(function(){return t(o,0,!1),i.find("li.active").index()},angular.noop))}var s=new i(n,t,{scrollingTabsActiveOffset:o.scrollingTabsActiveOffset}),l=n.find("uib-tabset").length>0,c=l||n.find("tabset, .scrtabs-tabs-movable-container div > ul.nav").length>0,b=o.scrollToTabEdge&&"true"===o.scrollToTabEdge.toLowerCase(),d={hasTabContentOutsideMovableContainer:!0};if(angular.extend(e,{scrtc:d}),o.refreshOn&&e.$watch(o.refreshOn,function(t,e){t&&t!==e&&s.handleTriggeredRefresh()}),c||(s.removeTranscludedTabContentOutsideMovableContainer(),d.hasTabContentOutsideMovableContainer=!1),!l&&!o.watchTabs)return void s.initTabs({isWrapperDirective:!0,isWrappingAngularUITabset:c,scrollToTabEdge:b});(!(l||o.watchTabs&&"true"===o.watchTabs.toLowerCase())||(c&&(s.removeTranscludedTabContentOutsideMovableContainer(),d.hasTabContentOutsideMovableContainer=!1),r(),t(a,10),l&&o.watchTabs&&"true"!==o.watchTabs.toLowerCase()))&&e.$watch(o.watchTabs,function(e){c?l&&e.length&&e[e.length-1].active&&t(function(){n.find(".scrtabs-tabs-movable-container ul.nav-tabs > li:last").find('a[role="tab"],a.nav-link').click()},0):e.length&&e[e.length-1].active&&t(function(){n.find("ul.nav-tabs > li:last").removeClass("active").find('a[role="tab"]').click()},0),r()},!0)}}}var s={CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL:50,SCROLL_OFFSET_FRACTION:6,DATA_KEY_IS_MOUSEDOWN:"ismousedown"},l=angular.module("mj.scrollingTabs",[]),c=['<div class="scrtabs-tab-container">',' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-left"><span class="glyphicon glyphicon-chevron-left"></span></div>','   <div class="scrtabs-tabs-fixed-container">','     <div class="scrtabs-tabs-movable-container">','       <ul class="nav nav-tabs" role="tablist">',"         <li ng-class=\"{ 'active': tab[propActive || 'active'], ","                         'disabled': tab[propDisabled || 'disabled'] }\" ",'             data-tab="{{tab}}" data-index="{{$index}}" ng-repeat="tab in tabsArr">',"           <a ng-href=\"{{'#' + tab[propPaneId || 'paneId']}}\" role=\"tab\"","                data-toggle=\"{{tab[propDisabled || 'disabled'] ? '' : 'tab'}}\" ","                ng-bind-html=\"sanitize(tab[propTitle || 'title']);\">","           </a>","         </li>","       </ul>","     </div>"," </div>",' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-right"><span class="glyphicon glyphicon-chevron-right"></span></div>',"</div>"].join(""),b=['<div class="scrtabs-tab-wrapper-container" ng-class="{ \'force-height\': !scrtc.hasTabContentOutsideMovableContainer }">',' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-left"><span class="glyphicon glyphicon-chevron-left"></span></div>','   <div class="scrtabs-tabs-fixed-container">','     <div class="scrtabs-tabs-movable-container" ng-transclude></div>',"   </div>",' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-right"><span class="glyphicon glyphicon-chevron-right"></span></div>',"</div>"].join("");!function(t,e){var n=function(t,e,n){var o=void 0;return function(){function i(){n||t.apply(r,a),o=null}var r=this,a=arguments;o?clearTimeout(o):n&&t.apply(r,a),o=setTimeout(i,e||100)}};jQuery.fn[e]=function(t){return t?this.bind("resize.scrtabs",n(t)):this.trigger(e)}}(jQuery,"smartresize"),function(t){t.handleClickOnLeftScrollArrow=function(){this.stc.scrollMovement.incrementScrollLeft()},t.handleClickOnRightScrollArrow=function(){var t=this,e=t.stc,n=e.scrollMovement;n.incrementScrollRight(n.getMinPos())},t.handleMousedownOnLeftScrollArrow=function(){this.stc.scrollMovement.startScrollLeft()},t.handleMousedownOnRightScrollArrow=function(){this.stc.scrollMovement.startScrollRight()},t.handleMouseupOnLeftScrollArrow=function(){this.stc.scrollMovement.stopScrollLeft()},t.handleMouseupOnRightScrollArrow=function(){this.stc.scrollMovement.stopScrollRight()},t.handleWindowResize=function(){var t=this,e=t.stc,n=e.$win.width();if(n===e.winWidth)return!1;e.winWidth=n,e.elementsHandler.refreshAllElementSizes()}}(e.prototype),function(e){e.initElements=function(t){var e=this;e.setElementReferences(),t.isWrappingAngularUITabset&&e.moveTabContentOutsideScrollContainer(t),e.setEventListeners()},e.moveTabContentOutsideScrollContainer=function(t){var e=this,n=e.stc,o=n.$tabsContainer,i=o.find(".scrtabs-tabs-movable-container .tab-content");if(!t.isWatchingTabs)return void i.show().appendTo(o);var r=i.clone().addClass("scrtabs-tab-content-clone"),a=o.find(".scrtabs-tab-content-clone");a.length?a.replaceWith(r):o.append(r)},e.refreshAllElementSizes=function(){var t=this,e=t.stc,n=e.scrollMovement,o=e.scrollArrowsVisible,i={didScrollToActiveTab:!1},r=void 0;return t.setElementWidths(),t.setScrollArrowVisibility(),e.scrollArrowsVisible&&t.setFixedContainerWidthForJustVisibleScrollArrows(),(e.scrollArrowsVisible||o)&&(e.scrollArrowsVisible?(r=n.getMinPos(),e.movableContainerLeftPos<r?n.incrementScrollRight(r):(n.scrollToActiveTab({isOnWindowResize:!0}),i.didScrollToActiveTab=!0)):(e.movableContainerLeftPos=0,n.slideMovableContainerToLeftPos())),i},e.removeTranscludedTabContentOutsideMovableContainer=function(){this.stc.$tabsContainer.find(".scrtabs-tab-content-outside-movable-container").remove()},e.setElementReferences=function(){var e=this,n=e.stc,o=n.$tabsContainer;n.isNavPills=!1,n.$fixedContainer=o.find(".scrtabs-tabs-fixed-container"),n.$movableContainer=o.find(".scrtabs-tabs-movable-container"),n.$tabsUl=n.$movableContainer.find(".nav-tabs"),n.$tabsUl.length||(n.$tabsUl=n.$movableContainer.find(".nav-pills"),n.$tabsUl.length&&(n.isNavPills=!0)),n.$tabsLiCollection=n.$tabsUl.find("> li"),n.$leftScrollArrow=o.find(".scrtabs-js-tab-scroll-arrow-left"),n.$rightScrollArrow=o.find(".scrtabs-js-tab-scroll-arrow-right"),n.$scrollArrows=n.$leftScrollArrow.add(n.$rightScrollArrow),n.$win=t(window)},e.setElementWidths=function(){var t=this,e=t.stc;e.$win&&(e.containerWidth=e.$tabsContainer.outerWidth(),e.winWidth=e.$win.width(),e.scrollArrowsCombinedWidth=e.$leftScrollArrow.outerWidth()+e.$rightScrollArrow.outerWidth(),t.setFixedContainerWidth(),t.setMovableContainerWidth())},e.setEventListeners=function(){var t=this,e=t.stc,n=e.eventHandlers;e.$leftScrollArrow.off(".scrtabs").on({"mousedown.scrtabs touchstart.scrtabs":function(t){n.handleMousedownOnLeftScrollArrow.call(n,t)},"mouseup.scrtabs touchend.scrtabs":function(t){n.handleMouseupOnLeftScrollArrow.call(n,t)},"click.scrtabs":function(t){n.handleClickOnLeftScrollArrow.call(n,t)}}),e.$rightScrollArrow.off(".scrtabs").on({"mousedown.scrtabs touchstart.scrtabs":function(t){n.handleMousedownOnRightScrollArrow.call(n,t)},"mouseup.scrtabs touchend.scrtabs":function(t){n.handleMouseupOnRightScrollArrow.call(n,t)},"click.scrtabs":function(t){n.handleClickOnRightScrollArrow.call(n,t)}}),e.$win.off(".scrtabs").smartresize(function(t){n.handleWindowResize.call(n,t)})},e.setFixedContainerWidth=function(){var t=this,e=t.stc,n=e.$tabsContainer.get(0).getBoundingClientRect();e.fixedContainerWidth=n.width||n.right-n.left,e.$fixedContainer.width(e.fixedContainerWidth)},e.setFixedContainerWidthForJustHiddenScrollArrows=function(){var t=this,e=t.stc;e.$fixedContainer.width(e.fixedContainerWidth)},e.setFixedContainerWidthForJustVisibleScrollArrows=function(){var t=this,e=t.stc;e.$fixedContainer.width(e.fixedContainerWidth-e.scrollArrowsCombinedWidth)},e.setMovableContainerWidth=function(){var e=this,n=e.stc,o=n.$tabsUl.find("li"),i=n.$fixedContainer.height(),r=10;for(n.movableContainerWidth=0,o.length&&(o.each(function(){var e=t(this),o=0;n.isNavPills&&(o=parseInt(e.css("margin-left"),10)+parseInt(e.css("margin-right"),10)),n.movableContainerWidth+=e.outerWidth()+o}),n.movableContainerWidth+=1,n.movableContainerWidth<n.fixedContainerWidth&&(n.movableContainerWidth=n.fixedContainerWidth)),n.$movableContainer.width(n.movableContainerWidth);n.$movableContainer.height()>i&&r--;)n.$movableContainer.width(n.movableContainerWidth+=1)},e.setScrollArrowVisibility=function(){var t=this,e=t.stc,n=e.movableContainerWidth>e.fixedContainerWidth;n&&!e.scrollArrowsVisible?(e.$scrollArrows.show(),e.scrollArrowsVisible=!0,t.setFixedContainerWidthForJustVisibleScrollArrows()):!n&&e.scrollArrowsVisible&&(e.$scrollArrows.hide(),e.scrollArrowsVisible=!1,t.setFixedContainerWidthForJustHiddenScrollArrows())}}(n.prototype),function(e){e.continueScrollLeft=function(){var t=this,e=t.stc;e.$timeout(function(){e.$leftScrollArrow.data(s.DATA_KEY_IS_MOUSEDOWN)&&e.movableContainerLeftPos<0&&(t.incrementScrollLeft()||t.continueScrollLeft())},s.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)},e.continueScrollRight=function(t){var e=this,n=e.stc;n.$timeout(function(){n.$rightScrollArrow.data(s.DATA_KEY_IS_MOUSEDOWN)&&n.movableContainerLeftPos>t&&(e.incrementScrollRight(t)||e.continueScrollRight(t))},s.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)},e.decrementMovableContainerLeftPos=function(t){var e=this,n=e.stc;n.movableContainerLeftPos-=n.fixedContainerWidth/s.SCROLL_OFFSET_FRACTION,n.movableContainerLeftPos<t?n.movableContainerLeftPos=t:n.scrollToTabEdge&&(e.setMovableContainerLeftPosToTabEdge("right"),n.movableContainerLeftPos<t&&(n.movableContainerLeftPos=t))},e.getMinPos=function(){var t=this,e=t.stc;return e.scrollArrowsVisible?e.fixedContainerWidth-e.movableContainerWidth-e.scrollArrowsCombinedWidth:0},e.getMovableContainerCssLeftVal=function(){var t=this,e=t.stc;return 0===e.movableContainerLeftPos?"0":e.movableContainerLeftPos+"px"},e.incrementScrollLeft=function(){var t=this,e=t.stc;return e.movableContainerLeftPos+=e.fixedContainerWidth/s.SCROLL_OFFSET_FRACTION,e.movableContainerLeftPos>0?e.movableContainerLeftPos=0:e.scrollToTabEdge&&(t.setMovableContainerLeftPosToTabEdge("left"),e.movableContainerLeftPos>0&&(e.movableContainerLeftPos=0)),t.slideMovableContainerToLeftPos(),0===e.movableContainerLeftPos},e.incrementScrollRight=function(t){var e=this,n=e.stc;return e.decrementMovableContainerLeftPos(t),e.slideMovableContainerToLeftPos(),n.movableContainerLeftPos===t},e.scrollToActiveTab=function(){var t=this,e=t.stc,n=0,o=void 0;if(e.scrollArrowsVisible){var i=e.$tabsUl.find("li.active");if(i.length){var r=i.offset().left,a=i.outerWidth(),s=r+a+parseInt(e.scrollingTabsActiveOffset||0,10),l=e.$rightScrollArrow.offset().left,c=e.$leftScrollArrow.outerWidth(),b=c,d=l;r<b?(n=r-b,e.movableContainerLeftPos-=n):s>d&&(n=s-d,e.movableContainerLeftPos-=n),n?(o=t.getMinPos(),e.movableContainerLeftPos<o?e.movableContainerLeftPos=o:e.movableContainerLeftPos>0&&(e.movableContainerLeftPos=0),t.slideMovableContainerToLeftPos()):e.handleArrowsClassNames("left")}}},e.setMovableContainerLeftPosToTabEdge=function(e){var n=this,o=n.stc,i=-o.movableContainerLeftPos,r=0;o.$tabsLiCollection.each(function(){var n=t(this).width();if((r+=n)>i)return o.movableContainerLeftPos="left"===e?-(r-n):-r,!1})},e.slideMovableContainerToLeftPos=function(){var t=this,e=t.stc;e.movableContainerLeftPos/=1;var n=t.getMovableContainerCssLeftVal();e.$movableContainer.stop().animate({left:n},"slow",function(){var n=t.getMinPos();e.movableContainerLeftPos<n&&(t.decrementMovableContainerLeftPos(n),e.$movableContainer.stop().animate({left:t.getMovableContainerCssLeftVal()},"fast"));var o=void 0;e.movableContainerLeftPos<=0&&e.movableContainerLeftPos>=-2?o="left":e.movableContainerLeftPos-n>=0&&e.movableContainerLeftPos-n<=2&&(o="right"),e.handleArrowsClassNames(o)})},e.startScrollLeft=function(){var t=this;t.stc.$leftScrollArrow.data(s.DATA_KEY_IS_MOUSEDOWN,!0),t.continueScrollLeft()},e.startScrollRight=function(){var t=this;t.stc.$rightScrollArrow.data(s.DATA_KEY_IS_MOUSEDOWN,!0),t.continueScrollRight(t.getMinPos())},e.stopScrollLeft=function(){this.stc.$leftScrollArrow.data(s.DATA_KEY_IS_MOUSEDOWN,!1)},e.stopScrollRight=function(){this.stc.$rightScrollArrow.data(s.DATA_KEY_IS_MOUSEDOWN,!1)}}(o.prototype),function(t){t.handleTriggeredRefresh=function(){var t=this,e=t.scrollMovement;t.elementsHandler.refreshAllElementSizes(!0).didScrollToActiveTab||t.$timeout(function(){e.scrollToActiveTab({isOnTabsRefresh:!0})},100)},t.initTabs=function(t){var e=this,n=e.elementsHandler,o=e.scrollMovement;t.scrollToTabEdge&&(e.scrollToTabEdge=!0),e.$timeout(function(){var e=n.refreshAllElementSizes();n.initElements(t),e.didScrollToActiveTab||o.scrollToActiveTab({isOnTabsRefresh:t.isWatchingTabs})},100)},t.removeTranscludedTabContentOutsideMovableContainer=function(){this.elementsHandler.removeTranscludedTabContentOutsideMovableContainer()},t.handleArrowsClassNames=function(t){var e=this,n="scrtabs-tab-scroll-arrow--is-on-edge",o={left:e.$leftScrollArrow,right:e.$rightScrollArrow};t?(o[t].addClass(n),o["left"==t?"right":"left"].removeClass(n)):(o.left.removeClass(n),o.right.removeClass(n))}}(i.prototype),r.$inject=["$timeout","$sce"],a.$inject=["$timeout"],l.directive("scrollingTabs",r),l.directive("scrollingTabsWrapper",a)}(jQuery);